
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../hero-microservice/">
      
      
        <link rel="next" href="../containers-cloud/">
      
      
      <link rel="icon" href="../images/logo.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Transactions and ORM - Quarkus OpenShift Workshop</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#transactions-and-orm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
You are not viewing the latest version.
<a href="../..">
    <strong>Click here to go to latest.</strong>
</a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Quarkus OpenShift Workshop" class="md-header__button md-logo" aria-label="Quarkus OpenShift Workshop" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Quarkus OpenShift Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Transactions and ORM
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6v1m7-4.68V17c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1v-2.26C3.19 13.47 2 11.38 2 9c0-3.87 3.13-7 7-7 1.65 0 3.16.57 4.35 1.5C10.8 4.57 9 7.07 9 10c0 2.79 1.64 5.19 4 6.32m7.92-6.38-1.42-.91-1.4.97.4-1.65-1.33-1.03 1.68-.11.56-1.61.63 1.58 1.68.04-1.3 1.08.5 1.64M19.39 13c-1.89 2.27-5.36 2.19-7.17-.05C10 10.13 11.56 6 15 5.34c.34-.05.64.29.5.63-.45 1.28-.38 2.74.35 4a4.622 4.622 0 0 0 3.27 2.28c.35.05.5.49.27.75Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 6a6 6 0 0 1 6 6c0 2.22-1.21 4.16-3 5.2V19a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-1.8c-1.79-1.04-3-2.98-3-5.2a6 6 0 0 1 6-6m2 15v1a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-1h4m6-10h3v2h-3v-2M1 11h3v2H1v-2M13 1v3h-2V1h2M4.92 3.5l2.13 2.14-1.42 1.41L3.5 4.93 4.92 3.5m12.03 2.13 2.12-2.13 1.43 1.43-2.13 2.12-1.42-1.42Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/cescoffier/quarkus-openshift-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Quarkus OpenShift Workshop" class="md-nav__button md-logo" aria-label="Quarkus OpenShift Workshop" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    Quarkus OpenShift Workshop
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cescoffier/quarkus-openshift-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Presenting the Workshop
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software requirements
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Creating a REST/HTTP microservices
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Creating a REST/HTTP microservices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hero-microservice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hero Microservice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Transactions and ORM
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Transactions and ORM
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#database-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Database dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hero-entity" class="md-nav__link">
    <span class="md-ellipsis">
      Hero Entity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hero Entity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-hibernate" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Hibernate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Hibernate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-data" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#heroresource-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      HeroResource Endpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HeroResource Endpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#making-heroresource-transactional" class="md-nav__link">
    <span class="md-ellipsis">
      Making HeroResource Transactional
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-the-datasource-for-production" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring the Datasource for Production
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crud-tests-in-heroresourcetest" class="md-nav__link">
    <span class="md-ellipsis">
      CRUD Tests in HeroResourceTest
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../containers-cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From Git to OpenShift
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trusted-apps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Red Hat Trusted Application Pipelines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../open-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    One microservice is not microservices
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            One microservice is not microservices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../villain-microservice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Villain microservice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fight-microservice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intelligent Fight microservice
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../web-application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Interface
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../conclusion-references/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conclusion
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#database-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      Database dependencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hero-entity" class="md-nav__link">
    <span class="md-ellipsis">
      Hero Entity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hero Entity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-hibernate" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Hibernate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Hibernate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-data" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#heroresource-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      HeroResource Endpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HeroResource Endpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#making-heroresource-transactional" class="md-nav__link">
    <span class="md-ellipsis">
      Making HeroResource Transactional
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-the-datasource-for-production" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring the Datasource for Production
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crud-tests-in-heroresourcetest" class="md-nav__link">
    <span class="md-ellipsis">
      CRUD Tests in HeroResourceTest
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="transactions-and-orm">Transactions and ORM<a class="headerlink" href="#transactions-and-orm" title="Permanent link"></a></h1>
<p>The Hero API&rsquo;s role is to allow CRUD operations on Super Heroes.
In this module we will create a Hero entity and persist/update/delete/retrieve it from a Postgres database in a transactional way.</p>
<h2 id="directory-structure">Directory Structure<a class="headerlink" href="#directory-structure" title="Permanent link"></a></h2>
<p>In this module we will add extra classes to the Hero API project.
You will end-up with the following directory structure:</p>
<p><img alt="hero-transaction-orm-directory-structure" src="../target/hero-transaction-orm-directory-structure.svg" /></p>
<h2 id="database-dependencies">Database dependencies<a class="headerlink" href="#database-dependencies" title="Permanent link"></a></h2>
<p>This microservice:</p>
<ul>
<li>interacts with a PostGreSQL database - so it needs a driver</li>
<li>uses Hibernate with Panache - so need the dependency on it</li>
<li>validates payloads and entities - so need a validator</li>
<li>consumes and produces JSON - so we need a mapper</li>
</ul>
<p>Hibernate ORM is the de-facto JPA implementation and offers you the full breadth of an Object Relational Mapper.
It makes complex mappings possible, but it does not make simple and common mappings trivial.
<a href="https://github.com/quarkusio/quarkus/tree/master/extensions/panache">Hibernate ORM with Panache</a> focuses on making your entities trivial and fun to write in Quarkus.</p>
<p>Because JPA and Bean Validation work well together, we will use Bean Validation to constrain our business model.</p>
<p>All the needed dependencies to access the database are already in the pom.xml file. Check that you have the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">io</span><span class="p">.</span><span class="na">quarkus</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">quarkus</span><span class="o">-</span><span class="n">jdbc</span><span class="o">-</span><span class="n">postgresql</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">io</span><span class="p">.</span><span class="na">quarkus</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">quarkus</span><span class="o">-</span><span class="n">hibernate</span><span class="o">-</span><span class="n">orm</span><span class="o">-</span><span class="n">panache</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">io</span><span class="p">.</span><span class="na">quarkus</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">quarkus</span><span class="o">-</span><span class="n">hibernate</span><span class="o">-</span><span class="n">validator</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">io</span><span class="p">.</span><span class="na">quarkus</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">quarkus</span><span class="o">-</span><span class="n">rest</span><span class="o">-</span><span class="n">jackson</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>If you need to add them, just run the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span>./mvnw<span class="w"> </span>quarkus:add-extension<span class="w"> </span>-Dextensions<span class="o">=</span><span class="s2">&quot;jdbc-postgresql,hibernate-orm-panache,hibernate-validator,rest-jackson&quot;</span>
</code></pre></div>
<p>From now on, you can choose to either edit your pom directly or use the <code>quarkus:add-extension</code> command.</p>
<h2 id="hero-entity">Hero Entity<a class="headerlink" href="#hero-entity" title="Permanent link"></a></h2>
<p>To define a Panache entity, simply extend <code>PanacheEntity</code>, annotate it with <code>@Entity</code> and add your columns as public fields (no need to have getters and setters).
Create a new java class under <code>src/main/java/io/quarkus/workshop/hero</code> and copy the following content:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span>
<span class="normal"><a href="#__codelineno-2-32">32</a></span>
<span class="normal"><a href="#__codelineno-2-33">33</a></span>
<span class="normal"><a href="#__codelineno-2-34">34</a></span>
<span class="normal"><a href="#__codelineno-2-35">35</a></span>
<span class="normal"><a href="#__codelineno-2-36">36</a></span>
<span class="normal"><a href="#__codelineno-2-37">37</a></span>
<span class="normal"><a href="#__codelineno-2-38">38</a></span>
<span class="normal"><a href="#__codelineno-2-39">39</a></span>
<span class="normal"><a href="#__codelineno-2-40">40</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">io.quarkus.workshop.hero</span><span class="p">;</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.quarkus.hibernate.orm.panache.PanacheEntity</span><span class="p">;</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.persistence.Column</span><span class="p">;</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.persistence.Entity</span><span class="p">;</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.Min</span><span class="p">;</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.NotNull</span><span class="p">;</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.Size</span><span class="p">;</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Random</span><span class="p">;</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="nd">@Entity</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Hero</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">PanacheEntity</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">    </span><span class="nd">@NotNull</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="w">    </span><span class="nd">@Size</span><span class="p">(</span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">otherName</span><span class="p">;</span>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="w">    </span><span class="nd">@NotNull</span>
<a id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="w">    </span><span class="nd">@Min</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">level</span><span class="p">;</span>
<a id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">picture</span><span class="p">;</span>
<a id="__codelineno-2-26" name="__codelineno-2-26"></a>
<a id="__codelineno-2-27" name="__codelineno-2-27"></a><span class="w">    </span><span class="nd">@Column</span><span class="p">(</span><span class="n">columnDefinition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;TEXT&quot;</span><span class="p">)</span>
<a id="__codelineno-2-28" name="__codelineno-2-28"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">powers</span><span class="p">;</span>
<a id="__codelineno-2-29" name="__codelineno-2-29"></a>
<a id="__codelineno-2-30" name="__codelineno-2-30"></a><span class="w">    </span><span class="nd">@Override</span>
<a id="__codelineno-2-31" name="__codelineno-2-31"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-32" name="__codelineno-2-32"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Hero{&quot;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-2-33" name="__codelineno-2-33"></a><span class="w">                </span><span class="s">&quot;id=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-2-34" name="__codelineno-2-34"></a><span class="w">                </span><span class="s">&quot;, name=&#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;\&#39;&#39;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-2-35" name="__codelineno-2-35"></a><span class="w">                </span><span class="s">&quot;, otherName=&#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">otherName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;\&#39;&#39;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-2-36" name="__codelineno-2-36"></a><span class="w">                </span><span class="s">&quot;, level=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-2-37" name="__codelineno-2-37"></a><span class="w">                </span><span class="s">&quot;, picture=&#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">picture</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;\&#39;&#39;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-2-38" name="__codelineno-2-38"></a><span class="w">                </span><span class="s">&quot;, powers=&#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">powers</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;\&#39;&#39;</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-2-39" name="__codelineno-2-39"></a><span class="w">                </span><span class="sc">&#39;}&#39;</span><span class="p">;</span>
<a id="__codelineno-2-40" name="__codelineno-2-40"></a><span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Notice that you can put all your JPA column annotations and Bean Validation constraint annotations on the public fields.</p>
<h3 id="adding-operations">Adding Operations<a class="headerlink" href="#adding-operations" title="Permanent link"></a></h3>
<p>Thanks to Panache, once you have written the <code>Hero</code> entity, here are the most common operations you will be able to do:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">// creating a hero</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">Hero</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hero</span><span class="p">();</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">hero</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Superman&quot;</span><span class="p">;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">hero</span><span class="p">.</span><span class="na">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c1">// persist it</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">hero</span><span class="p">.</span><span class="na">persist</span><span class="p">();</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c1">// getting a list of all Hero entities</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;</span><span class="w"> </span><span class="n">heroes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hero</span><span class="p">.</span><span class="na">listAll</span><span class="p">();</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c1">// finding a specific hero by ID</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="n">hero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hero</span><span class="p">.</span><span class="na">findById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="c1">// counting all heroes</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="kt">long</span><span class="w"> </span><span class="n">countAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hero</span><span class="p">.</span><span class="na">count</span><span class="p">();</span>
</code></pre></div>
<p>But we are missing a business method:
we need to return a random hero.
For that it&rsquo;s just a matter to add the following method to our <code>Hero.java</code> entity:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Hero</span><span class="w"> </span><span class="nf">findRandom</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">    </span><span class="n">Random</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">();</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">();</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">.</span><span class="na">nextInt</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">findAll</span><span class="p">().</span><span class="na">page</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">).</span><span class="na">firstResult</span><span class="p">();</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>NOTE</strong></p>
<p>You would need to add the following import statement if not done automatically by your IDE <code>import java.util.Random;</code></p>
<h2 id="configuring-hibernate">Configuring Hibernate<a class="headerlink" href="#configuring-hibernate" title="Permanent link"></a></h2>
<p>As Quarkus supports the automatic provisioning of unconfigured services in development and test mode, we don&rsquo;t need at the moment to configure anything regarding the database access. 
Quarkus will automatically start a Postgresql service and wire up your application to use this service. </p>
<p>Quarkus development mode is really useful for applications that mix front end or services and database access.
We use <code>quarkus.hibernate-orm.database.generation=drop-and-create</code> in conjunction with <code>import.sql</code> so every change to your app and in particular to your entities, the database schema will be properly recreated and your data (stored in <code>import.sql</code>) will be used to repopulate it from scratch.
This is best to perfectly control your environment and works magic with Quarkus live reload mode:
your entity changes or any change to your <code>import.sql</code> is immediately picked up and the schema updated without restarting the application!</p>
<p>For that, make sure to have the following configuration in your <code>application.properties</code> (located in <code>src/main/resources</code>):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="na">quarkus.hibernate-orm.database.generation</span><span class="o">=</span><span class="s">drop-and-create</span>
</code></pre></div></td></tr></table></div>
<h3 id="adding-data">Adding Data<a class="headerlink" href="#adding-data" title="Permanent link"></a></h3>
<p>Then, note that the file import.sql under src/main/resources contains SQL statements terminated by a semicolon.
This is useful to have a data set ready for the tests or demos.
Now, you have around 500 heroes that will be loaded in the database.</p>
<h2 id="heroresource-endpoint">HeroResource Endpoint<a class="headerlink" href="#heroresource-endpoint" title="Permanent link"></a></h2>
<p>The <code>HeroResource</code> Endpoint was bootstrapped with only one method <code>hello()</code>.
We need to add extra methods that will allow CRUD operations on heroes.</p>
<h3 id="making-heroresource-transactional">Making HeroResource Transactional<a class="headerlink" href="#making-heroresource-transactional" title="Permanent link"></a></h3>
<p>To manipulate the <code>Hero</code> entity we need make <code>HeroResource</code> transactional.
The idea is to wrap methods modifying the database (e.g. <code>entity.persist()</code>) within a transaction.
Marking a CDI bean method <code>@Transactional</code> will do that for you and make that method a transaction boundary.</p>
<p><code>@Transactional</code> can be used to control transaction boundaries on any CDI bean at the method level or at the class level to ensure every method is transactional.</p>
<p>Here are the new methods to add to the <code>HeroResource</code> class:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span>
<span class="normal"><a href="#__codelineno-6-26">26</a></span>
<span class="normal"><a href="#__codelineno-6-27">27</a></span>
<span class="normal"><a href="#__codelineno-6-28">28</a></span>
<span class="normal"><a href="#__codelineno-6-29">29</a></span>
<span class="normal"><a href="#__codelineno-6-30">30</a></span>
<span class="normal"><a href="#__codelineno-6-31">31</a></span>
<span class="normal"><a href="#__codelineno-6-32">32</a></span>
<span class="normal"><a href="#__codelineno-6-33">33</a></span>
<span class="normal"><a href="#__codelineno-6-34">34</a></span>
<span class="normal"><a href="#__codelineno-6-35">35</a></span>
<span class="normal"><a href="#__codelineno-6-36">36</a></span>
<span class="normal"><a href="#__codelineno-6-37">37</a></span>
<span class="normal"><a href="#__codelineno-6-38">38</a></span>
<span class="normal"><a href="#__codelineno-6-39">39</a></span>
<span class="normal"><a href="#__codelineno-6-40">40</a></span>
<span class="normal"><a href="#__codelineno-6-41">41</a></span>
<span class="normal"><a href="#__codelineno-6-42">42</a></span>
<span class="normal"><a href="#__codelineno-6-43">43</a></span>
<span class="normal"><a href="#__codelineno-6-44">44</a></span>
<span class="normal"><a href="#__codelineno-6-45">45</a></span>
<span class="normal"><a href="#__codelineno-6-46">46</a></span>
<span class="normal"><a href="#__codelineno-6-47">47</a></span>
<span class="normal"><a href="#__codelineno-6-48">48</a></span>
<span class="normal"><a href="#__codelineno-6-49">49</a></span>
<span class="normal"><a href="#__codelineno-6-50">50</a></span>
<span class="normal"><a href="#__codelineno-6-51">51</a></span>
<span class="normal"><a href="#__codelineno-6-52">52</a></span>
<span class="normal"><a href="#__codelineno-6-53">53</a></span>
<span class="normal"><a href="#__codelineno-6-54">54</a></span>
<span class="normal"><a href="#__codelineno-6-55">55</a></span>
<span class="normal"><a href="#__codelineno-6-56">56</a></span>
<span class="normal"><a href="#__codelineno-6-57">57</a></span>
<span class="normal"><a href="#__codelineno-6-58">58</a></span>
<span class="normal"><a href="#__codelineno-6-59">59</a></span>
<span class="normal"><a href="#__codelineno-6-60">60</a></span>
<span class="normal"><a href="#__codelineno-6-61">61</a></span>
<span class="normal"><a href="#__codelineno-6-62">62</a></span>
<span class="normal"><a href="#__codelineno-6-63">63</a></span>
<span class="normal"><a href="#__codelineno-6-64">64</a></span>
<span class="normal"><a href="#__codelineno-6-65">65</a></span>
<span class="normal"><a href="#__codelineno-6-66">66</a></span>
<span class="normal"><a href="#__codelineno-6-67">67</a></span>
<span class="normal"><a href="#__codelineno-6-68">68</a></span>
<span class="normal"><a href="#__codelineno-6-69">69</a></span>
<span class="normal"><a href="#__codelineno-6-70">70</a></span>
<span class="normal"><a href="#__codelineno-6-71">71</a></span>
<span class="normal"><a href="#__codelineno-6-72">72</a></span>
<span class="normal"><a href="#__codelineno-6-73">73</a></span>
<span class="normal"><a href="#__codelineno-6-74">74</a></span>
<span class="normal"><a href="#__codelineno-6-75">75</a></span>
<span class="normal"><a href="#__codelineno-6-76">76</a></span>
<span class="normal"><a href="#__codelineno-6-77">77</a></span>
<span class="normal"><a href="#__codelineno-6-78">78</a></span>
<span class="normal"><a href="#__codelineno-6-79">79</a></span>
<span class="normal"><a href="#__codelineno-6-80">80</a></span>
<span class="normal"><a href="#__codelineno-6-81">81</a></span>
<span class="normal"><a href="#__codelineno-6-82">82</a></span>
<span class="normal"><a href="#__codelineno-6-83">83</a></span>
<span class="normal"><a href="#__codelineno-6-84">84</a></span>
<span class="normal"><a href="#__codelineno-6-85">85</a></span>
<span class="normal"><a href="#__codelineno-6-86">86</a></span>
<span class="normal"><a href="#__codelineno-6-87">87</a></span>
<span class="normal"><a href="#__codelineno-6-88">88</a></span>
<span class="normal"><a href="#__codelineno-6-89">89</a></span>
<span class="normal"><a href="#__codelineno-6-90">90</a></span>
<span class="normal"><a href="#__codelineno-6-91">91</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">io.quarkus.workshop.hero</span><span class="p">;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.quarkus.logging.Log</span><span class="p">;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.smallrye.common.annotation.RunOnVirtualThread</span><span class="p">;</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.transaction.Transactional</span><span class="p">;</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.Valid</span><span class="p">;</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.ws.rs.DELETE</span><span class="p">;</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.ws.rs.GET</span><span class="p">;</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.ws.rs.POST</span><span class="p">;</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.ws.rs.PUT</span><span class="p">;</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.ws.rs.Path</span><span class="p">;</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.Context</span><span class="p">;</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.UriBuilder</span><span class="p">;</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.UriInfo</span><span class="p">;</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.jboss.resteasy.reactive.RestResponse</span><span class="p">;</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.URI</span><span class="p">;</span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/api/heroes&quot;</span><span class="p">)</span>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="nd">@RunOnVirtualThread</span>
<a id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">HeroResource</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-23" name="__codelineno-6-23"></a>
<a id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="w">    </span><span class="nd">@GET</span>
<a id="__codelineno-6-25" name="__codelineno-6-25"></a><span class="w">    </span><span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/random&quot;</span><span class="p">)</span>
<a id="__codelineno-6-26" name="__codelineno-6-26"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">RestResponse</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getRandomHero</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hero</span><span class="p">.</span><span class="na">findRandom</span><span class="p">();</span>
<a id="__codelineno-6-28" name="__codelineno-6-28"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hero</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-29" name="__codelineno-6-29"></a><span class="w">            </span><span class="n">Log</span><span class="p">.</span><span class="na">debugf</span><span class="p">(</span><span class="s">&quot;Found random hero: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hero</span><span class="p">);</span>
<a id="__codelineno-6-30" name="__codelineno-6-30"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">RestResponse</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">hero</span><span class="p">);</span>
<a id="__codelineno-6-31" name="__codelineno-6-31"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-32" name="__codelineno-6-32"></a><span class="w">            </span><span class="n">Log</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;No random hero found&quot;</span><span class="p">);</span>
<a id="__codelineno-6-33" name="__codelineno-6-33"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">RestResponse</span><span class="p">.</span><span class="na">notFound</span><span class="p">();</span>
<a id="__codelineno-6-34" name="__codelineno-6-34"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-6-35" name="__codelineno-6-35"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-36" name="__codelineno-6-36"></a>
<a id="__codelineno-6-37" name="__codelineno-6-37"></a><span class="w">    </span><span class="nd">@GET</span>
<a id="__codelineno-6-38" name="__codelineno-6-38"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getAllHeroes</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-39" name="__codelineno-6-39"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Hero</span><span class="p">.</span><span class="na">listAll</span><span class="p">();</span>
<a id="__codelineno-6-40" name="__codelineno-6-40"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-41" name="__codelineno-6-41"></a>
<a id="__codelineno-6-42" name="__codelineno-6-42"></a><span class="w">    </span><span class="nd">@GET</span>
<a id="__codelineno-6-43" name="__codelineno-6-43"></a><span class="w">    </span><span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/{id}&quot;</span><span class="p">)</span>
<a id="__codelineno-6-44" name="__codelineno-6-44"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">RestResponse</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getHero</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-45" name="__codelineno-6-45"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hero</span><span class="p">.</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;</span><span class="n">findById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<a id="__codelineno-6-46" name="__codelineno-6-46"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hero</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-47" name="__codelineno-6-47"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">RestResponse</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">hero</span><span class="p">);</span>
<a id="__codelineno-6-48" name="__codelineno-6-48"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-49" name="__codelineno-6-49"></a><span class="w">            </span><span class="n">Log</span><span class="p">.</span><span class="na">debugf</span><span class="p">(</span><span class="s">&quot;No Hero found with id %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<a id="__codelineno-6-50" name="__codelineno-6-50"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">RestResponse</span><span class="p">.</span><span class="na">notFound</span><span class="p">();</span>
<a id="__codelineno-6-51" name="__codelineno-6-51"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-6-52" name="__codelineno-6-52"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-53" name="__codelineno-6-53"></a>
<a id="__codelineno-6-54" name="__codelineno-6-54"></a><span class="w">    </span><span class="nd">@POST</span>
<a id="__codelineno-6-55" name="__codelineno-6-55"></a><span class="w">    </span><span class="nd">@Transactional</span>
<a id="__codelineno-6-56" name="__codelineno-6-56"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">RestResponse</span><span class="o">&lt;</span><span class="n">URI</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">createHero</span><span class="p">(</span><span class="nd">@Valid</span><span class="w"> </span><span class="n">Hero</span><span class="w"> </span><span class="n">hero</span><span class="p">,</span><span class="w"> </span><span class="nd">@Context</span><span class="w"> </span><span class="n">UriInfo</span><span class="w"> </span><span class="n">uriInfo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-57" name="__codelineno-6-57"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">persist</span><span class="p">();</span>
<a id="__codelineno-6-58" name="__codelineno-6-58"></a><span class="w">        </span><span class="n">UriBuilder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uriInfo</span><span class="p">.</span><span class="na">getAbsolutePathBuilder</span><span class="p">().</span><span class="na">path</span><span class="p">(</span><span class="n">Long</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">hero</span><span class="p">.</span><span class="na">id</span><span class="p">));</span>
<a id="__codelineno-6-59" name="__codelineno-6-59"></a><span class="w">        </span><span class="n">Log</span><span class="p">.</span><span class="na">debugf</span><span class="p">(</span><span class="s">&quot;New Hero created with URI %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">build</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span>
<a id="__codelineno-6-60" name="__codelineno-6-60"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">RestResponse</span><span class="p">.</span><span class="na">created</span><span class="p">(</span><span class="n">builder</span><span class="p">.</span><span class="na">build</span><span class="p">());</span>
<a id="__codelineno-6-61" name="__codelineno-6-61"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-62" name="__codelineno-6-62"></a>
<a id="__codelineno-6-63" name="__codelineno-6-63"></a><span class="w">    </span><span class="nd">@PUT</span>
<a id="__codelineno-6-64" name="__codelineno-6-64"></a><span class="w">    </span><span class="nd">@Transactional</span>
<a id="__codelineno-6-65" name="__codelineno-6-65"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Hero</span><span class="w"> </span><span class="nf">updateHero</span><span class="p">(</span><span class="nd">@Valid</span><span class="w"> </span><span class="n">Hero</span><span class="w"> </span><span class="n">hero</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-66" name="__codelineno-6-66"></a><span class="w">        </span><span class="n">Hero</span><span class="w"> </span><span class="n">retrieved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hero</span><span class="p">.</span><span class="na">findById</span><span class="p">(</span><span class="n">hero</span><span class="p">.</span><span class="na">id</span><span class="p">);</span>
<a id="__codelineno-6-67" name="__codelineno-6-67"></a><span class="w">        </span><span class="n">retrieved</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hero</span><span class="p">.</span><span class="na">name</span><span class="p">;</span>
<a id="__codelineno-6-68" name="__codelineno-6-68"></a><span class="w">        </span><span class="n">retrieved</span><span class="p">.</span><span class="na">otherName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hero</span><span class="p">.</span><span class="na">otherName</span><span class="p">;</span>
<a id="__codelineno-6-69" name="__codelineno-6-69"></a><span class="w">        </span><span class="n">retrieved</span><span class="p">.</span><span class="na">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hero</span><span class="p">.</span><span class="na">level</span><span class="p">;</span>
<a id="__codelineno-6-70" name="__codelineno-6-70"></a><span class="w">        </span><span class="n">retrieved</span><span class="p">.</span><span class="na">picture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hero</span><span class="p">.</span><span class="na">picture</span><span class="p">;</span>
<a id="__codelineno-6-71" name="__codelineno-6-71"></a><span class="w">        </span><span class="n">retrieved</span><span class="p">.</span><span class="na">powers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hero</span><span class="p">.</span><span class="na">powers</span><span class="p">;</span>
<a id="__codelineno-6-72" name="__codelineno-6-72"></a><span class="w">        </span><span class="n">Log</span><span class="p">.</span><span class="na">debugf</span><span class="p">(</span><span class="s">&quot;Hero updated with new valued %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">retrieved</span><span class="p">);</span>
<a id="__codelineno-6-73" name="__codelineno-6-73"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">retrieved</span><span class="p">;</span>
<a id="__codelineno-6-74" name="__codelineno-6-74"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-75" name="__codelineno-6-75"></a>
<a id="__codelineno-6-76" name="__codelineno-6-76"></a><span class="w">    </span><span class="nd">@DELETE</span>
<a id="__codelineno-6-77" name="__codelineno-6-77"></a><span class="w">    </span><span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/{id}&quot;</span><span class="p">)</span>
<a id="__codelineno-6-78" name="__codelineno-6-78"></a><span class="w">    </span><span class="nd">@Transactional</span>
<a id="__codelineno-6-79" name="__codelineno-6-79"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">RestResponse</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">deleteHero</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-80" name="__codelineno-6-80"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Hero</span><span class="p">.</span><span class="na">deleteById</span><span class="p">(</span><span class="n">id</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-81" name="__codelineno-6-81"></a><span class="w">            </span><span class="n">Log</span><span class="p">.</span><span class="na">debugf</span><span class="p">(</span><span class="s">&quot;Hero deleted with %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<a id="__codelineno-6-82" name="__codelineno-6-82"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-6-83" name="__codelineno-6-83"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">RestResponse</span><span class="p">.</span><span class="na">noContent</span><span class="p">();</span>
<a id="__codelineno-6-84" name="__codelineno-6-84"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-85" name="__codelineno-6-85"></a>
<a id="__codelineno-6-86" name="__codelineno-6-86"></a><span class="w">    </span><span class="nd">@GET</span>
<a id="__codelineno-6-87" name="__codelineno-6-87"></a><span class="w">    </span><span class="nd">@Path</span><span class="p">(</span><span class="s">&quot;/hello&quot;</span><span class="p">)</span>
<a id="__codelineno-6-88" name="__codelineno-6-88"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">hello</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-89" name="__codelineno-6-89"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Hello Hero Service&quot;</span><span class="p">;</span>
<a id="__codelineno-6-90" name="__codelineno-6-90"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-91" name="__codelineno-6-91"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Notice that both methods that persist and update a hero, pass a <code>Hero</code> object as a parameter.
Thanks to the Bean Validation&rsquo;s <code>@Valid</code> annotation, the <code>Hero</code> object will be checked to see if it&rsquo;s valid or not.
It it&rsquo;s not, the transaction will be rollback-ed.</p>
<p>If you didn&rsquo;t yet, start the application in dev mode:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>$./mvnw<span class="w"> </span>quarkus:dev
</code></pre></div>
or</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>$<span class="w"> </span>quarkus<span class="w"> </span>dev
</code></pre></div>
<p>Then, open your browser to $URL/api/heroes.
You should see lots of heroes&hellip;</p>
<h2 id="configuring-the-datasource-for-production">Configuring the Datasource for Production<a class="headerlink" href="#configuring-the-datasource-for-production" title="Permanent link"></a></h2>
<p>Production databases need to be configured as normal. 
So if you want to include a production database config in your <code>application.properties</code> and continue to use Dev Services,
we recommend that you use the <code>%prod</code> profile to define your database settings.</p>
<p>Just add the following datasource configuration in the <code>src/main/resources/application.properties</code> file:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="na">%prod.quarkus.datasource.db-kind</span><span class="o">=</span><span class="s">postgresql</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="na">%prod.quarkus.datasource.username</span><span class="o">=</span><span class="s">${POSTGRESQL_USERNAME}</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="na">%prod.quarkus.datasource.password</span><span class="o">=</span><span class="s">${POSTGRESQL_USERNAME}</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="na">%prod.quarkus.datasource.jdbc.url</span><span class="o">=</span><span class="s">jdbc:postgresql://hero-database:5432/${POSTGRESQL_DATABASE}</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="na">%prod.quarkus.hibernate-orm.sql-load-script</span><span class="o">=</span><span class="s">import.sql</span>
</code></pre></div></td></tr></table></div>
<h2 id="crud-tests-in-heroresourcetest">CRUD Tests in HeroResourceTest<a class="headerlink" href="#crud-tests-in-heroresourcetest" title="Permanent link"></a></h2>
<p>To test the <code>HeroResource</code> endpoint, we will be using a <code>@QuarkusTest</code> that will fire a Postgres database and then test CRUD operations.</p>
<p>In the generated build file, you can see 2 test dependencies:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="nt">&lt;dependency&gt;</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>io.quarkus<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>quarkus-junit5<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">    </span><span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="nt">&lt;/dependency&gt;</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="nt">&lt;dependency&gt;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>io.rest-assured<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>rest-assured<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">    </span><span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></td></tr></table></div>
<p>Also, the generated project contains a simple test. Edit the HeroResourceTest.java to match the following content:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">  1</a></span>
<span class="normal"><a href="#__codelineno-11-2">  2</a></span>
<span class="normal"><a href="#__codelineno-11-3">  3</a></span>
<span class="normal"><a href="#__codelineno-11-4">  4</a></span>
<span class="normal"><a href="#__codelineno-11-5">  5</a></span>
<span class="normal"><a href="#__codelineno-11-6">  6</a></span>
<span class="normal"><a href="#__codelineno-11-7">  7</a></span>
<span class="normal"><a href="#__codelineno-11-8">  8</a></span>
<span class="normal"><a href="#__codelineno-11-9">  9</a></span>
<span class="normal"><a href="#__codelineno-11-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-11-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-11-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-11-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-11-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-11-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-11-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-11-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-11-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-11-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-11-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-11-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-11-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-11-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-11-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-11-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-11-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-11-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-11-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-11-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-11-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-11-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-11-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-11-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-11-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-11-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-11-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-11-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-11-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-11-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-11-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-11-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-11-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-11-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-11-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-11-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-11-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-11-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-11-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-11-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-11-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-11-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-11-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-11-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-11-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-11-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-11-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-11-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-11-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-11-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-11-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-11-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-11-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-11-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-11-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-11-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-11-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-11-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-11-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-11-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-11-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-11-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-11-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-11-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-11-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-11-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-11-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-11-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-11-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-11-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-11-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-11-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-11-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-11-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-11-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-11-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-11-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-11-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-11-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-11-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-11-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-11-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-11-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-11-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-11-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-11-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-11-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-11-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-11-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-11-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-11-100">100</a></span>
<span class="normal"><a href="#__codelineno-11-101">101</a></span>
<span class="normal"><a href="#__codelineno-11-102">102</a></span>
<span class="normal"><a href="#__codelineno-11-103">103</a></span>
<span class="normal"><a href="#__codelineno-11-104">104</a></span>
<span class="normal"><a href="#__codelineno-11-105">105</a></span>
<span class="normal"><a href="#__codelineno-11-106">106</a></span>
<span class="normal"><a href="#__codelineno-11-107">107</a></span>
<span class="normal"><a href="#__codelineno-11-108">108</a></span>
<span class="normal"><a href="#__codelineno-11-109">109</a></span>
<span class="normal"><a href="#__codelineno-11-110">110</a></span>
<span class="normal"><a href="#__codelineno-11-111">111</a></span>
<span class="normal"><a href="#__codelineno-11-112">112</a></span>
<span class="normal"><a href="#__codelineno-11-113">113</a></span>
<span class="normal"><a href="#__codelineno-11-114">114</a></span>
<span class="normal"><a href="#__codelineno-11-115">115</a></span>
<span class="normal"><a href="#__codelineno-11-116">116</a></span>
<span class="normal"><a href="#__codelineno-11-117">117</a></span>
<span class="normal"><a href="#__codelineno-11-118">118</a></span>
<span class="normal"><a href="#__codelineno-11-119">119</a></span>
<span class="normal"><a href="#__codelineno-11-120">120</a></span>
<span class="normal"><a href="#__codelineno-11-121">121</a></span>
<span class="normal"><a href="#__codelineno-11-122">122</a></span>
<span class="normal"><a href="#__codelineno-11-123">123</a></span>
<span class="normal"><a href="#__codelineno-11-124">124</a></span>
<span class="normal"><a href="#__codelineno-11-125">125</a></span>
<span class="normal"><a href="#__codelineno-11-126">126</a></span>
<span class="normal"><a href="#__codelineno-11-127">127</a></span>
<span class="normal"><a href="#__codelineno-11-128">128</a></span>
<span class="normal"><a href="#__codelineno-11-129">129</a></span>
<span class="normal"><a href="#__codelineno-11-130">130</a></span>
<span class="normal"><a href="#__codelineno-11-131">131</a></span>
<span class="normal"><a href="#__codelineno-11-132">132</a></span>
<span class="normal"><a href="#__codelineno-11-133">133</a></span>
<span class="normal"><a href="#__codelineno-11-134">134</a></span>
<span class="normal"><a href="#__codelineno-11-135">135</a></span>
<span class="normal"><a href="#__codelineno-11-136">136</a></span>
<span class="normal"><a href="#__codelineno-11-137">137</a></span>
<span class="normal"><a href="#__codelineno-11-138">138</a></span>
<span class="normal"><a href="#__codelineno-11-139">139</a></span>
<span class="normal"><a href="#__codelineno-11-140">140</a></span>
<span class="normal"><a href="#__codelineno-11-141">141</a></span>
<span class="normal"><a href="#__codelineno-11-142">142</a></span>
<span class="normal"><a href="#__codelineno-11-143">143</a></span>
<span class="normal"><a href="#__codelineno-11-144">144</a></span>
<span class="normal"><a href="#__codelineno-11-145">145</a></span>
<span class="normal"><a href="#__codelineno-11-146">146</a></span>
<span class="normal"><a href="#__codelineno-11-147">147</a></span>
<span class="normal"><a href="#__codelineno-11-148">148</a></span>
<span class="normal"><a href="#__codelineno-11-149">149</a></span>
<span class="normal"><a href="#__codelineno-11-150">150</a></span>
<span class="normal"><a href="#__codelineno-11-151">151</a></span>
<span class="normal"><a href="#__codelineno-11-152">152</a></span>
<span class="normal"><a href="#__codelineno-11-153">153</a></span>
<span class="normal"><a href="#__codelineno-11-154">154</a></span>
<span class="normal"><a href="#__codelineno-11-155">155</a></span>
<span class="normal"><a href="#__codelineno-11-156">156</a></span>
<span class="normal"><a href="#__codelineno-11-157">157</a></span>
<span class="normal"><a href="#__codelineno-11-158">158</a></span>
<span class="normal"><a href="#__codelineno-11-159">159</a></span>
<span class="normal"><a href="#__codelineno-11-160">160</a></span>
<span class="normal"><a href="#__codelineno-11-161">161</a></span>
<span class="normal"><a href="#__codelineno-11-162">162</a></span>
<span class="normal"><a href="#__codelineno-11-163">163</a></span>
<span class="normal"><a href="#__codelineno-11-164">164</a></span>
<span class="normal"><a href="#__codelineno-11-165">165</a></span>
<span class="normal"><a href="#__codelineno-11-166">166</a></span>
<span class="normal"><a href="#__codelineno-11-167">167</a></span>
<span class="normal"><a href="#__codelineno-11-168">168</a></span>
<span class="normal"><a href="#__codelineno-11-169">169</a></span>
<span class="normal"><a href="#__codelineno-11-170">170</a></span>
<span class="normal"><a href="#__codelineno-11-171">171</a></span>
<span class="normal"><a href="#__codelineno-11-172">172</a></span>
<span class="normal"><a href="#__codelineno-11-173">173</a></span>
<span class="normal"><a href="#__codelineno-11-174">174</a></span>
<span class="normal"><a href="#__codelineno-11-175">175</a></span>
<span class="normal"><a href="#__codelineno-11-176">176</a></span>
<span class="normal"><a href="#__codelineno-11-177">177</a></span>
<span class="normal"><a href="#__codelineno-11-178">178</a></span>
<span class="normal"><a href="#__codelineno-11-179">179</a></span>
<span class="normal"><a href="#__codelineno-11-180">180</a></span>
<span class="normal"><a href="#__codelineno-11-181">181</a></span>
<span class="normal"><a href="#__codelineno-11-182">182</a></span>
<span class="normal"><a href="#__codelineno-11-183">183</a></span>
<span class="normal"><a href="#__codelineno-11-184">184</a></span>
<span class="normal"><a href="#__codelineno-11-185">185</a></span>
<span class="normal"><a href="#__codelineno-11-186">186</a></span>
<span class="normal"><a href="#__codelineno-11-187">187</a></span>
<span class="normal"><a href="#__codelineno-11-188">188</a></span>
<span class="normal"><a href="#__codelineno-11-189">189</a></span>
<span class="normal"><a href="#__codelineno-11-190">190</a></span>
<span class="normal"><a href="#__codelineno-11-191">191</a></span>
<span class="normal"><a href="#__codelineno-11-192">192</a></span>
<span class="normal"><a href="#__codelineno-11-193">193</a></span>
<span class="normal"><a href="#__codelineno-11-194">194</a></span>
<span class="normal"><a href="#__codelineno-11-195">195</a></span>
<span class="normal"><a href="#__codelineno-11-196">196</a></span>
<span class="normal"><a href="#__codelineno-11-197">197</a></span>
<span class="normal"><a href="#__codelineno-11-198">198</a></span>
<span class="normal"><a href="#__codelineno-11-199">199</a></span>
<span class="normal"><a href="#__codelineno-11-200">200</a></span>
<span class="normal"><a href="#__codelineno-11-201">201</a></span>
<span class="normal"><a href="#__codelineno-11-202">202</a></span>
<span class="normal"><a href="#__codelineno-11-203">203</a></span>
<span class="normal"><a href="#__codelineno-11-204">204</a></span>
<span class="normal"><a href="#__codelineno-11-205">205</a></span>
<span class="normal"><a href="#__codelineno-11-206">206</a></span>
<span class="normal"><a href="#__codelineno-11-207">207</a></span>
<span class="normal"><a href="#__codelineno-11-208">208</a></span>
<span class="normal"><a href="#__codelineno-11-209">209</a></span>
<span class="normal"><a href="#__codelineno-11-210">210</a></span>
<span class="normal"><a href="#__codelineno-11-211">211</a></span>
<span class="normal"><a href="#__codelineno-11-212">212</a></span>
<span class="normal"><a href="#__codelineno-11-213">213</a></span>
<span class="normal"><a href="#__codelineno-11-214">214</a></span>
<span class="normal"><a href="#__codelineno-11-215">215</a></span>
<span class="normal"><a href="#__codelineno-11-216">216</a></span>
<span class="normal"><a href="#__codelineno-11-217">217</a></span>
<span class="normal"><a href="#__codelineno-11-218">218</a></span>
<span class="normal"><a href="#__codelineno-11-219">219</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">io.quarkus.workshop.hero</span><span class="p">;</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.quarkus.test.junit.QuarkusTest</span><span class="p">;</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.restassured.common.mapper.TypeRef</span><span class="p">;</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.hamcrest.core.Is</span><span class="p">;</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.MethodOrderer</span><span class="p">;</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Order</span><span class="p">;</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.TestMethodOrder</span><span class="p">;</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Random</span><span class="p">;</span>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">io.restassured.RestAssured.get</span><span class="p">;</span>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">io.restassured.RestAssured.given</span><span class="p">;</span>
<a id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.HttpHeaders.ACCEPT</span><span class="p">;</span>
<a id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.HttpHeaders.CONTENT_TYPE</span><span class="p">;</span>
<a id="__codelineno-11-18" name="__codelineno-11-18"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.MediaType.APPLICATION_JSON</span><span class="p">;</span>
<a id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.Response.Status.BAD_REQUEST</span><span class="p">;</span>
<a id="__codelineno-11-20" name="__codelineno-11-20"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.Response.Status.CREATED</span><span class="p">;</span>
<a id="__codelineno-11-21" name="__codelineno-11-21"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.Response.Status.NOT_FOUND</span><span class="p">;</span>
<a id="__codelineno-11-22" name="__codelineno-11-22"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.Response.Status.NO_CONTENT</span><span class="p">;</span>
<a id="__codelineno-11-23" name="__codelineno-11-23"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">jakarta.ws.rs.core.Response.Status.OK</span><span class="p">;</span>
<a id="__codelineno-11-24" name="__codelineno-11-24"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">org.hamcrest.Matchers.is</span><span class="p">;</span>
<a id="__codelineno-11-25" name="__codelineno-11-25"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Assertions.assertEquals</span><span class="p">;</span>
<a id="__codelineno-11-26" name="__codelineno-11-26"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Assertions.assertNotNull</span><span class="p">;</span>
<a id="__codelineno-11-27" name="__codelineno-11-27"></a><span class="kn">import static</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Assertions.assertTrue</span><span class="p">;</span>
<a id="__codelineno-11-28" name="__codelineno-11-28"></a>
<a id="__codelineno-11-29" name="__codelineno-11-29"></a><span class="nd">@QuarkusTest</span>
<a id="__codelineno-11-30" name="__codelineno-11-30"></a><span class="nd">@TestMethodOrder</span><span class="p">(</span><span class="n">MethodOrderer</span><span class="p">.</span><span class="na">OrderAnnotation</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-11-31" name="__codelineno-11-31"></a><span class="kd">class</span> <span class="nc">HeroResourceTest</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-32" name="__codelineno-11-32"></a>
<a id="__codelineno-11-33" name="__codelineno-11-33"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;application/json;charset=UTF-8&quot;</span><span class="p">;</span>
<a id="__codelineno-11-34" name="__codelineno-11-34"></a>
<a id="__codelineno-11-35" name="__codelineno-11-35"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">DEFAULT_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Super Baguette&quot;</span><span class="p">;</span>
<a id="__codelineno-11-36" name="__codelineno-11-36"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">UPDATED_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Super Baguette (updated)&quot;</span><span class="p">;</span>
<a id="__codelineno-11-37" name="__codelineno-11-37"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">DEFAULT_OTHER_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Super Baguette Tradition&quot;</span><span class="p">;</span>
<a id="__codelineno-11-38" name="__codelineno-11-38"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">UPDATED_OTHER_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Super Baguette Tradition (updated)&quot;</span><span class="p">;</span>
<a id="__codelineno-11-39" name="__codelineno-11-39"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">DEFAULT_PICTURE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;super_baguette.png&quot;</span><span class="p">;</span>
<a id="__codelineno-11-40" name="__codelineno-11-40"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">UPDATED_PICTURE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;super_baguette_updated.png&quot;</span><span class="p">;</span>
<a id="__codelineno-11-41" name="__codelineno-11-41"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">DEFAULT_POWERS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;eats baguette really quickly&quot;</span><span class="p">;</span>
<a id="__codelineno-11-42" name="__codelineno-11-42"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">UPDATED_POWERS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;eats baguette really quickly (updated)&quot;</span><span class="p">;</span>
<a id="__codelineno-11-43" name="__codelineno-11-43"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">DEFAULT_LEVEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span>
<a id="__codelineno-11-44" name="__codelineno-11-44"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">UPDATED_LEVEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">43</span><span class="p">;</span>
<a id="__codelineno-11-45" name="__codelineno-11-45"></a>
<a id="__codelineno-11-46" name="__codelineno-11-46"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">NB_HEROES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="p">;</span>
<a id="__codelineno-11-47" name="__codelineno-11-47"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">heroId</span><span class="p">;</span>
<a id="__codelineno-11-48" name="__codelineno-11-48"></a>
<a id="__codelineno-11-49" name="__codelineno-11-49"></a>
<a id="__codelineno-11-50" name="__codelineno-11-50"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-11-51" name="__codelineno-11-51"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">testHelloEndpoint</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-52" name="__codelineno-11-52"></a><span class="w">        </span><span class="n">given</span><span class="p">()</span>
<a id="__codelineno-11-53" name="__codelineno-11-53"></a><span class="w">                </span><span class="p">.</span><span class="na">when</span><span class="p">()</span>
<a id="__codelineno-11-54" name="__codelineno-11-54"></a><span class="w">                </span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;/api/heroes/hello&quot;</span><span class="p">)</span>
<a id="__codelineno-11-55" name="__codelineno-11-55"></a><span class="w">                </span><span class="p">.</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-56" name="__codelineno-11-56"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<a id="__codelineno-11-57" name="__codelineno-11-57"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="n">is</span><span class="p">(</span><span class="s">&quot;Hello Hero Service&quot;</span><span class="p">));</span>
<a id="__codelineno-11-58" name="__codelineno-11-58"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-59" name="__codelineno-11-59"></a>
<a id="__codelineno-11-60" name="__codelineno-11-60"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-11-61" name="__codelineno-11-61"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldNotGetUnknownHero</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-62" name="__codelineno-11-62"></a><span class="w">        </span><span class="n">Long</span><span class="w"> </span><span class="n">randomId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">().</span><span class="na">nextLong</span><span class="p">();</span>
<a id="__codelineno-11-63" name="__codelineno-11-63"></a><span class="w">        </span><span class="n">given</span><span class="p">()</span>
<a id="__codelineno-11-64" name="__codelineno-11-64"></a><span class="w">                </span><span class="p">.</span><span class="na">pathParam</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">randomId</span><span class="p">)</span>
<a id="__codelineno-11-65" name="__codelineno-11-65"></a><span class="w">                </span><span class="p">.</span><span class="na">when</span><span class="p">()</span>
<a id="__codelineno-11-66" name="__codelineno-11-66"></a><span class="w">                </span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;/api/heroes/{id}&quot;</span><span class="p">)</span>
<a id="__codelineno-11-67" name="__codelineno-11-67"></a><span class="w">                </span><span class="p">.</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-68" name="__codelineno-11-68"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">NOT_FOUND</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">());</span>
<a id="__codelineno-11-69" name="__codelineno-11-69"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-70" name="__codelineno-11-70"></a>
<a id="__codelineno-11-71" name="__codelineno-11-71"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-11-72" name="__codelineno-11-72"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldGetRandomHero</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-73" name="__codelineno-11-73"></a><span class="w">        </span><span class="n">given</span><span class="p">()</span>
<a id="__codelineno-11-74" name="__codelineno-11-74"></a><span class="w">                </span><span class="p">.</span><span class="na">when</span><span class="p">()</span>
<a id="__codelineno-11-75" name="__codelineno-11-75"></a><span class="w">                </span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;/api/heroes/random&quot;</span><span class="p">)</span>
<a id="__codelineno-11-76" name="__codelineno-11-76"></a><span class="w">                </span><span class="p">.</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-77" name="__codelineno-11-77"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">OK</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">())</span>
<a id="__codelineno-11-78" name="__codelineno-11-78"></a><span class="w">                </span><span class="p">.</span><span class="na">contentType</span><span class="p">(</span><span class="n">APPLICATION_JSON</span><span class="p">);</span>
<a id="__codelineno-11-79" name="__codelineno-11-79"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-80" name="__codelineno-11-80"></a>
<a id="__codelineno-11-81" name="__codelineno-11-81"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-11-82" name="__codelineno-11-82"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldNotAddInvalidItem</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-83" name="__codelineno-11-83"></a><span class="w">        </span><span class="n">Hero</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hero</span><span class="p">();</span>
<a id="__codelineno-11-84" name="__codelineno-11-84"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-11-85" name="__codelineno-11-85"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">otherName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_OTHER_NAME</span><span class="p">;</span>
<a id="__codelineno-11-86" name="__codelineno-11-86"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">picture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_PICTURE</span><span class="p">;</span>
<a id="__codelineno-11-87" name="__codelineno-11-87"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">powers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_POWERS</span><span class="p">;</span>
<a id="__codelineno-11-88" name="__codelineno-11-88"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-11-89" name="__codelineno-11-89"></a>
<a id="__codelineno-11-90" name="__codelineno-11-90"></a><span class="w">        </span><span class="n">given</span><span class="p">()</span>
<a id="__codelineno-11-91" name="__codelineno-11-91"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="n">hero</span><span class="p">)</span>
<a id="__codelineno-11-92" name="__codelineno-11-92"></a><span class="w">                </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="n">CONTENT_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-93" name="__codelineno-11-93"></a><span class="w">                </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="n">ACCEPT</span><span class="p">,</span><span class="w"> </span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-94" name="__codelineno-11-94"></a><span class="w">                </span><span class="p">.</span><span class="na">when</span><span class="p">()</span>
<a id="__codelineno-11-95" name="__codelineno-11-95"></a><span class="w">                </span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;/api/heroes&quot;</span><span class="p">)</span>
<a id="__codelineno-11-96" name="__codelineno-11-96"></a><span class="w">                </span><span class="p">.</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-97" name="__codelineno-11-97"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">BAD_REQUEST</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">());</span>
<a id="__codelineno-11-98" name="__codelineno-11-98"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-99" name="__codelineno-11-99"></a>
<a id="__codelineno-11-100" name="__codelineno-11-100"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-11-101" name="__codelineno-11-101"></a><span class="w">    </span><span class="nd">@Order</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-11-102" name="__codelineno-11-102"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldGetInitialItems</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-103" name="__codelineno-11-103"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;</span><span class="w"> </span><span class="n">heroes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/api/heroes&quot;</span><span class="p">).</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-104" name="__codelineno-11-104"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">OK</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">())</span>
<a id="__codelineno-11-105" name="__codelineno-11-105"></a><span class="w">                </span><span class="p">.</span><span class="na">contentType</span><span class="p">(</span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-106" name="__codelineno-11-106"></a><span class="w">                </span><span class="p">.</span><span class="na">extract</span><span class="p">()</span>
<a id="__codelineno-11-107" name="__codelineno-11-107"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">()</span>
<a id="__codelineno-11-108" name="__codelineno-11-108"></a><span class="w">                </span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="n">getHeroTypeRef</span><span class="p">());</span>
<a id="__codelineno-11-109" name="__codelineno-11-109"></a><span class="w">        </span><span class="n">assertEquals</span><span class="p">(</span><span class="n">NB_HEROES</span><span class="p">,</span><span class="w"> </span><span class="n">heroes</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<a id="__codelineno-11-110" name="__codelineno-11-110"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-111" name="__codelineno-11-111"></a>
<a id="__codelineno-11-112" name="__codelineno-11-112"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-11-113" name="__codelineno-11-113"></a><span class="w">    </span><span class="nd">@Order</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-11-114" name="__codelineno-11-114"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldAddAnItem</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-115" name="__codelineno-11-115"></a><span class="w">        </span><span class="n">Hero</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hero</span><span class="p">();</span>
<a id="__codelineno-11-116" name="__codelineno-11-116"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_NAME</span><span class="p">;</span>
<a id="__codelineno-11-117" name="__codelineno-11-117"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">otherName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_OTHER_NAME</span><span class="p">;</span>
<a id="__codelineno-11-118" name="__codelineno-11-118"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">picture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_PICTURE</span><span class="p">;</span>
<a id="__codelineno-11-119" name="__codelineno-11-119"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">powers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_POWERS</span><span class="p">;</span>
<a id="__codelineno-11-120" name="__codelineno-11-120"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_LEVEL</span><span class="p">;</span>
<a id="__codelineno-11-121" name="__codelineno-11-121"></a>
<a id="__codelineno-11-122" name="__codelineno-11-122"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">given</span><span class="p">()</span>
<a id="__codelineno-11-123" name="__codelineno-11-123"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="n">hero</span><span class="p">)</span>
<a id="__codelineno-11-124" name="__codelineno-11-124"></a><span class="w">                </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="n">CONTENT_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-125" name="__codelineno-11-125"></a><span class="w">                </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="n">ACCEPT</span><span class="p">,</span><span class="w"> </span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-126" name="__codelineno-11-126"></a><span class="w">                </span><span class="p">.</span><span class="na">when</span><span class="p">()</span>
<a id="__codelineno-11-127" name="__codelineno-11-127"></a><span class="w">                </span><span class="p">.</span><span class="na">post</span><span class="p">(</span><span class="s">&quot;/api/heroes&quot;</span><span class="p">)</span>
<a id="__codelineno-11-128" name="__codelineno-11-128"></a><span class="w">                </span><span class="p">.</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-129" name="__codelineno-11-129"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">CREATED</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">())</span>
<a id="__codelineno-11-130" name="__codelineno-11-130"></a><span class="w">                </span><span class="p">.</span><span class="na">extract</span><span class="p">()</span>
<a id="__codelineno-11-131" name="__codelineno-11-131"></a><span class="w">                </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="s">&quot;Location&quot;</span><span class="p">);</span>
<a id="__codelineno-11-132" name="__codelineno-11-132"></a><span class="w">        </span><span class="n">assertTrue</span><span class="p">(</span><span class="n">location</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;/api/heroes&quot;</span><span class="p">));</span>
<a id="__codelineno-11-133" name="__codelineno-11-133"></a>
<a id="__codelineno-11-134" name="__codelineno-11-134"></a><span class="w">        </span><span class="c1">// Stores the id</span>
<a id="__codelineno-11-135" name="__codelineno-11-135"></a><span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">segments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">);</span>
<a id="__codelineno-11-136" name="__codelineno-11-136"></a><span class="w">        </span><span class="n">heroId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">segments</span><span class="o">[</span><span class="n">segments</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>
<a id="__codelineno-11-137" name="__codelineno-11-137"></a><span class="w">        </span><span class="n">assertNotNull</span><span class="p">(</span><span class="n">heroId</span><span class="p">);</span>
<a id="__codelineno-11-138" name="__codelineno-11-138"></a>
<a id="__codelineno-11-139" name="__codelineno-11-139"></a><span class="w">        </span><span class="n">given</span><span class="p">()</span>
<a id="__codelineno-11-140" name="__codelineno-11-140"></a><span class="w">                </span><span class="p">.</span><span class="na">pathParam</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">heroId</span><span class="p">)</span>
<a id="__codelineno-11-141" name="__codelineno-11-141"></a><span class="w">                </span><span class="p">.</span><span class="na">when</span><span class="p">()</span>
<a id="__codelineno-11-142" name="__codelineno-11-142"></a><span class="w">                </span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;/api/heroes/{id}&quot;</span><span class="p">)</span>
<a id="__codelineno-11-143" name="__codelineno-11-143"></a><span class="w">                </span><span class="p">.</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-144" name="__codelineno-11-144"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">OK</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">())</span>
<a id="__codelineno-11-145" name="__codelineno-11-145"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">DEFAULT_NAME</span><span class="p">))</span>
<a id="__codelineno-11-146" name="__codelineno-11-146"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;otherName&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">DEFAULT_OTHER_NAME</span><span class="p">))</span>
<a id="__codelineno-11-147" name="__codelineno-11-147"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;level&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">DEFAULT_LEVEL</span><span class="p">))</span>
<a id="__codelineno-11-148" name="__codelineno-11-148"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;picture&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">DEFAULT_PICTURE</span><span class="p">))</span>
<a id="__codelineno-11-149" name="__codelineno-11-149"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;powers&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">DEFAULT_POWERS</span><span class="p">));</span>
<a id="__codelineno-11-150" name="__codelineno-11-150"></a>
<a id="__codelineno-11-151" name="__codelineno-11-151"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;</span><span class="w"> </span><span class="n">heroes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/api/heroes&quot;</span><span class="p">).</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-152" name="__codelineno-11-152"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">OK</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">())</span>
<a id="__codelineno-11-153" name="__codelineno-11-153"></a><span class="w">                </span><span class="p">.</span><span class="na">extract</span><span class="p">()</span>
<a id="__codelineno-11-154" name="__codelineno-11-154"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">()</span>
<a id="__codelineno-11-155" name="__codelineno-11-155"></a><span class="w">                </span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="n">getHeroTypeRef</span><span class="p">());</span>
<a id="__codelineno-11-156" name="__codelineno-11-156"></a><span class="w">        </span><span class="n">assertEquals</span><span class="p">(</span><span class="n">NB_HEROES</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">heroes</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<a id="__codelineno-11-157" name="__codelineno-11-157"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-158" name="__codelineno-11-158"></a>
<a id="__codelineno-11-159" name="__codelineno-11-159"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-11-160" name="__codelineno-11-160"></a><span class="w">    </span><span class="nd">@Order</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-11-161" name="__codelineno-11-161"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldUpdateAnItem</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-162" name="__codelineno-11-162"></a><span class="w">        </span><span class="n">Hero</span><span class="w"> </span><span class="n">hero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hero</span><span class="p">();</span>
<a id="__codelineno-11-163" name="__codelineno-11-163"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Long</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">heroId</span><span class="p">);</span>
<a id="__codelineno-11-164" name="__codelineno-11-164"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UPDATED_NAME</span><span class="p">;</span>
<a id="__codelineno-11-165" name="__codelineno-11-165"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">otherName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UPDATED_OTHER_NAME</span><span class="p">;</span>
<a id="__codelineno-11-166" name="__codelineno-11-166"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">picture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UPDATED_PICTURE</span><span class="p">;</span>
<a id="__codelineno-11-167" name="__codelineno-11-167"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">powers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UPDATED_POWERS</span><span class="p">;</span>
<a id="__codelineno-11-168" name="__codelineno-11-168"></a><span class="w">        </span><span class="n">hero</span><span class="p">.</span><span class="na">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UPDATED_LEVEL</span><span class="p">;</span>
<a id="__codelineno-11-169" name="__codelineno-11-169"></a>
<a id="__codelineno-11-170" name="__codelineno-11-170"></a><span class="w">        </span><span class="n">given</span><span class="p">()</span>
<a id="__codelineno-11-171" name="__codelineno-11-171"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="n">hero</span><span class="p">)</span>
<a id="__codelineno-11-172" name="__codelineno-11-172"></a><span class="w">                </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="n">CONTENT_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-173" name="__codelineno-11-173"></a><span class="w">                </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="n">ACCEPT</span><span class="p">,</span><span class="w"> </span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-174" name="__codelineno-11-174"></a><span class="w">                </span><span class="p">.</span><span class="na">when</span><span class="p">()</span>
<a id="__codelineno-11-175" name="__codelineno-11-175"></a><span class="w">                </span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;/api/heroes&quot;</span><span class="p">)</span>
<a id="__codelineno-11-176" name="__codelineno-11-176"></a><span class="w">                </span><span class="p">.</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-177" name="__codelineno-11-177"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">OK</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">())</span>
<a id="__codelineno-11-178" name="__codelineno-11-178"></a><span class="w">                </span><span class="p">.</span><span class="na">contentType</span><span class="p">(</span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-179" name="__codelineno-11-179"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">UPDATED_NAME</span><span class="p">))</span>
<a id="__codelineno-11-180" name="__codelineno-11-180"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;otherName&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">UPDATED_OTHER_NAME</span><span class="p">))</span>
<a id="__codelineno-11-181" name="__codelineno-11-181"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;level&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">UPDATED_LEVEL</span><span class="p">))</span>
<a id="__codelineno-11-182" name="__codelineno-11-182"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;picture&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">UPDATED_PICTURE</span><span class="p">))</span>
<a id="__codelineno-11-183" name="__codelineno-11-183"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="s">&quot;powers&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Is</span><span class="p">.</span><span class="na">is</span><span class="p">(</span><span class="n">UPDATED_POWERS</span><span class="p">));</span>
<a id="__codelineno-11-184" name="__codelineno-11-184"></a>
<a id="__codelineno-11-185" name="__codelineno-11-185"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;</span><span class="w"> </span><span class="n">heroes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/api/heroes&quot;</span><span class="p">).</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-186" name="__codelineno-11-186"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">OK</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">())</span>
<a id="__codelineno-11-187" name="__codelineno-11-187"></a><span class="w">                </span><span class="p">.</span><span class="na">contentType</span><span class="p">(</span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-188" name="__codelineno-11-188"></a><span class="w">                </span><span class="p">.</span><span class="na">extract</span><span class="p">()</span>
<a id="__codelineno-11-189" name="__codelineno-11-189"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">()</span>
<a id="__codelineno-11-190" name="__codelineno-11-190"></a><span class="w">                </span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="n">getHeroTypeRef</span><span class="p">());</span>
<a id="__codelineno-11-191" name="__codelineno-11-191"></a><span class="w">        </span><span class="n">assertEquals</span><span class="p">(</span><span class="n">NB_HEROES</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">heroes</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<a id="__codelineno-11-192" name="__codelineno-11-192"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-193" name="__codelineno-11-193"></a>
<a id="__codelineno-11-194" name="__codelineno-11-194"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-11-195" name="__codelineno-11-195"></a><span class="w">    </span><span class="nd">@Order</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-11-196" name="__codelineno-11-196"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldRemoveAnItem</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-197" name="__codelineno-11-197"></a><span class="w">        </span><span class="n">given</span><span class="p">()</span>
<a id="__codelineno-11-198" name="__codelineno-11-198"></a><span class="w">                </span><span class="p">.</span><span class="na">pathParam</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">heroId</span><span class="p">)</span>
<a id="__codelineno-11-199" name="__codelineno-11-199"></a><span class="w">                </span><span class="p">.</span><span class="na">when</span><span class="p">()</span>
<a id="__codelineno-11-200" name="__codelineno-11-200"></a><span class="w">                </span><span class="p">.</span><span class="na">delete</span><span class="p">(</span><span class="s">&quot;/api/heroes/{id}&quot;</span><span class="p">)</span>
<a id="__codelineno-11-201" name="__codelineno-11-201"></a><span class="w">                </span><span class="p">.</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-202" name="__codelineno-11-202"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">NO_CONTENT</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">());</span>
<a id="__codelineno-11-203" name="__codelineno-11-203"></a>
<a id="__codelineno-11-204" name="__codelineno-11-204"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;</span><span class="w"> </span><span class="n">heroes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/api/heroes&quot;</span><span class="p">).</span><span class="na">then</span><span class="p">()</span>
<a id="__codelineno-11-205" name="__codelineno-11-205"></a><span class="w">                </span><span class="p">.</span><span class="na">statusCode</span><span class="p">(</span><span class="n">OK</span><span class="p">.</span><span class="na">getStatusCode</span><span class="p">())</span>
<a id="__codelineno-11-206" name="__codelineno-11-206"></a><span class="w">                </span><span class="p">.</span><span class="na">contentType</span><span class="p">(</span><span class="n">APPLICATION_JSON</span><span class="p">)</span>
<a id="__codelineno-11-207" name="__codelineno-11-207"></a><span class="w">                </span><span class="p">.</span><span class="na">extract</span><span class="p">()</span>
<a id="__codelineno-11-208" name="__codelineno-11-208"></a><span class="w">                </span><span class="p">.</span><span class="na">body</span><span class="p">()</span>
<a id="__codelineno-11-209" name="__codelineno-11-209"></a><span class="w">                </span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="n">getHeroTypeRef</span><span class="p">());</span>
<a id="__codelineno-11-210" name="__codelineno-11-210"></a><span class="w">        </span><span class="n">assertEquals</span><span class="p">(</span><span class="n">NB_HEROES</span><span class="p">,</span><span class="w"> </span><span class="n">heroes</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<a id="__codelineno-11-211" name="__codelineno-11-211"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-212" name="__codelineno-11-212"></a>
<a id="__codelineno-11-213" name="__codelineno-11-213"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">TypeRef</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nf">getHeroTypeRef</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-214" name="__codelineno-11-214"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TypeRef</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Hero</span><span class="o">&gt;&gt;</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-215" name="__codelineno-11-215"></a><span class="w">            </span><span class="c1">// Kept empty on purpose</span>
<a id="__codelineno-11-216" name="__codelineno-11-216"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-11-217" name="__codelineno-11-217"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-218" name="__codelineno-11-218"></a>
<a id="__codelineno-11-219" name="__codelineno-11-219"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>The following test methods have been added to the <code>HeroResourceTest</code> class:</p>
<ul>
<li><code>shouldNotGetUnknownHero</code>: giving a random Hero identifier, the <code>HeroResource</code> endpoint should return a 204 (No content)</li>
<li><code>shouldGetRandomHero</code>: checks that the <code>HeroResource</code> endpoint returns a random hero</li>
<li><code>shouldNotAddInvalidItem</code>: passing an invalid <code>Hero</code> should fail when creating it (thanks to the <code>@Valid</code> annotation)</li>
<li><code>shouldGetInitialItems</code>: checks that the <code>HeroResource</code> endpoint returns the list of heroes</li>
<li><code>shouldAddAnItem</code>: checks that the <code>HeroResource</code> endpoint creates a valid <code>Hero</code></li>
<li><code>shouldUpdateAnItem</code>: checks that the <code>HeroResource</code> endpoint updates a newly created <code>Hero</code></li>
<li><code>shouldRemoveAnItem</code>: checks that the <code>HeroResource</code> endpoint deletes a hero from the database</li>
</ul>
<p>Let’s have a look to the 2 annotations used on the HeroResourceTest class. 
<code>@QuarkusTest</code> indicates that this test class is checking the behavior of a Quarkus application. 
The test framework starts the application before the test class and stops it once all the tests have been executed. 
In our case, we just execute HTTP requests to check the result.</p>
<p>With this code written, execute the test using <code>./mvnw test</code>.
The test should pass.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!--
  Copyright (c) 2016-2022 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Copyright and theme information, adapter to have the Red Hat footer -->
<div class="md-copyright">
    <div class="md-copyright__highlight">
        Sponsored by <a href="https://www.redhat.com"><img style="vertical-align: middle;" alt="Red Hat" src="../images/redhat_reversed.svg"/></a> <br/>
        <a href="https://creativecommons.org/licenses/by/3.0/">CC by 3.0</a> |
        <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </div>
    
    Made with
    <a
            href="https://squidfunk.github.io/mkdocs-material/"
            target="_blank" rel="noopener"
    >
        Material for MkDocs
    </a>
    
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "content.tabs.link", "content.code.annotate", "navigation.instant", "navigation.indexes", "navigation.tracking", "navigation.tabs.sticky", "content.code.select", "content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>